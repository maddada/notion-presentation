Notion Presenter Bookmarklet
============================

Create a new bookmark in your browser and paste this as the URL:

javascript:(function(){if(window.notionPresenter){document.removeEventListener('keydown',window.notionPresenter.handler,true)}var STORAGE_KEY='notion-presenter-state';var pageId=window.location.pathname.split('-').pop();function getBlocks(){var mainContent=document.querySelector('.notion-page-content');if(!mainContent)return[];var allBlocks=mainContent.querySelectorAll('[data-block-id]');var seen={};var blocks=[];for(var i=0;i<allBlocks.length;i++){var block=allBlocks[i];var id=block.getAttribute('data-block-id');if(!seen[id]){seen[id]=true;blocks.push(block)}}return blocks}function loadState(){try{var stored=localStorage.getItem(STORAGE_KEY);if(stored){var data=JSON.parse(stored);if(data.pageId===pageId){return data}}}catch(e){}return{pageId:pageId,visibleCount:0,showingAll:true}}function saveState(state){state.pageId=pageId;localStorage.setItem(STORAGE_KEY,JSON.stringify(state))}function expandAllToggles(){var toggles=document.querySelectorAll('.notion-toggle-block');var expanded=0;toggles.forEach(function(toggle){var button=toggle.querySelector('div[role="button"]');if(button){var svg=toggle.querySelector('svg');var transform=svg?svg.style.transform:'';var isCollapsed=transform.includes('-90');if(isCollapsed){button.click();expanded++}}});return expanded}function applyVisibility(state){var blocks=getBlocks();if(blocks.length===0)return;for(var i=0;i<blocks.length;i++){var block=blocks[i];if(state.showingAll){block.style.visibility='visible';block.style.opacity='1'}else{if(i<state.visibleCount){block.style.visibility='visible';block.style.opacity='1'}else{block.style.visibility='hidden';block.style.opacity='0'}}}}var state=loadState();function handleKeydown(e){if(!e.altKey)return;var blocks=getBlocks();if(blocks.length===0)return;if(e.code==='Digit5'){e.preventDefault();expandAllToggles()}if(e.code==='Digit4'){e.preventDefault();state.visibleCount=0;state.showingAll=false;applyVisibility(state);saveState(state)}if(e.code==='Digit3'){e.preventDefault();state.showingAll=!state.showingAll;applyVisibility(state);saveState(state)}if(e.code==='Digit2'){e.preventDefault();state.showingAll=false;if(state.visibleCount<blocks.length){state.visibleCount++}applyVisibility(state);saveState(state)}if(e.code==='Digit1'){e.preventDefault();state.showingAll=false;if(state.visibleCount>0){state.visibleCount--}applyVisibility(state);saveState(state)}}document.addEventListener('keydown',handleKeydown,true);applyVisibility(state);window.notionPresenter={handler:handleKeydown,state:state,apply:applyVisibility,expandToggles:expandAllToggles};alert('Notion Presenter loaded! '+getBlocks().length+' blocks')})();


Controls
========
- Option+5: Expand all toggle blocks
- Option+4: Reset state (hide all elements)
- Option+3: Toggle between showing all blocks vs. current progress
- Option+2: Reveal next block
- Option+1: Hide last revealed block

State persists in localStorage across page refreshes.
